{% load static %}

<nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-container">
    <!-- Brand -->
    <a href="{% url 'projects:home' %}" class="navbar-brand">
      <i class="fas fa-hand-holding-heart"></i>
      CrowdFunding
    </a>

    <!-- Mobile toggle button -->
    <button
      class="navbar-toggle"
      type="button"
      aria-expanded="false"
      aria-controls="navbar-nav"
      aria-label="Toggle navigation"
    >
      <span class="navbar-toggle-icon">
        <span></span>
        <span></span>
        <span></span>
      </span>
    </button>

    <!-- Navigation items -->
    <ul class="navbar-nav" id="navbar-nav">
      <!-- Main navigation links -->
      <li class="nav-item">
        <a
          class="nav-link {% if request.resolver_match.url_name == 'home' %}active{% endif %}"
          href="{% url 'projects:home' %}"
        >
          <i class="fas fa-home" aria-hidden="true"></i>
          Home
        </a>
      </li>

      <li class="nav-item">
        <a
          class="nav-link {% if request.resolver_match.url_name == 'project_list' %}active{% endif %}"
          href="{% url 'projects:list' %}"
        >
          <i class="fas fa-project-diagram" aria-hidden="true"></i>
          Projects
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="#how-it-works">
          <i class="fas fa-question-circle" aria-hidden="true"></i>
          How it Works
        </a>
      </li>

      <!-- Search form -->
      <li class="nav-item navbar-search">
        <form
          method="GET"
          action="{% url 'projects:list' %}"
          class="form-inline"
          data-search
        >
          <div class="form-group">
            <label for="search-input" class="sr-only">Search projects</label>
            <input
              type="text"
              name="q"
              id="search-input"
              class="form-control"
              placeholder="Search projects..."
              value="{{ request.GET.q }}"
              autocomplete="off"
              aria-describedby="search-help"
            />
            <button type="submit" class="btn btn-primary" aria-label="Search">
              <i class="fas fa-search" aria-hidden="true"></i>
            </button>
          </div>
          <div
            id="search-results"
            class="search-results"
            data-result-container
          ></div>
        </form>
      </li>

      <!-- User authentication section -->
      {% if user.is_authenticated %}
      <!-- User dropdown -->
      <li class="nav-item dropdown">
        <button
          class="dropdown-toggle nav-link"
          type="button"
          aria-expanded="false"
          aria-haspopup="true"
          aria-label="User menu"
        >
          <i class="fas fa-user" aria-hidden="true"></i>
          {{ user.get_full_name|default:user.username }}
          <i class="fas fa-chevron-down ml-1" aria-hidden="true"></i>
        </button>

        <div class="dropdown-menu" role="menu">
          <a
            class="dropdown-item"
            href="{% url 'accounts:profile' %}"
            role="menuitem"
          >
            <i class="fas fa-user-circle" aria-hidden="true"></i>
            Profile
          </a>

          <a
            class="dropdown-item"
            href="{% url 'projects:my_projects' %}"
            role="menuitem"
          >
            <i class="fas fa-folder" aria-hidden="true"></i>
            My Projects
          </a>

          <a
            class="dropdown-item"
            href="{% url 'projects:my_projects' %}"
            role="menuitem"
          >
            <i class="fas fa-heart" aria-hidden="true"></i>
            My Contributions
          </a>

          <div class="dropdown-divider" role="separator"></div>

          <a
            class="dropdown-item"
            href="{% url 'accounts:profile' %}"
            role="menuitem"
          >
            <i class="fas fa-cog" aria-hidden="true"></i>
            Settings
          </a>

          <a
            class="dropdown-item"
            href="{% url 'accounts:logout' %}"
            role="menuitem"
          >
            <i class="fas fa-sign-out-alt" aria-hidden="true"></i>
            Logout
          </a>
        </div>
      </li>

      <!-- Create project button -->
      <li class="nav-item">
        <a class="nav-link btn btn-primary" href="{% url 'projects:create' %}">
          <i class="fas fa-plus" aria-hidden="true"></i>
          Start Project
        </a>
      </li>

      <!-- Notifications (if implemented) -->
      {% if notifications %}
      <li class="nav-item notification">
        <a class="nav-link" href="#" aria-label="Notifications">
          <i class="fas fa-bell" aria-hidden="true"></i>
          {% if unread_notifications_count %}
          <span class="notification-badge"
            >{{ unread_notifications_count }}</span
          >
          {% endif %}
        </a>
      </li>
      {% endif %} {% else %}
      <!-- Guest user options -->
      <li class="nav-item">
        <a class="nav-link" href="{% url 'accounts:login' %}">
          <i class="fas fa-sign-in-alt" aria-hidden="true"></i>
          Login
        </a>
      </li>

      <li class="nav-item">
        <a
          class="nav-link btn btn-outline-primary"
          href="{% url 'accounts:register' %}"
        >
          <i class="fas fa-user-plus" aria-hidden="true"></i>
          Register
        </a>
      </li>
      {% endif %}
    </ul>
  </div>
</nav>

<!-- Skip to content link for accessibility -->
<a href="#main-content" class="skip-to-content sr-only-focusable">
  Skip to main content
</a>
