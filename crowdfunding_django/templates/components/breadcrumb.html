{% load static %}

{% if request.resolver_match.url_name != 'home' %}
<nav class="breadcrumb-nav" aria-label="Breadcrumb">
  <div class="container">
    <ol class="breadcrumb">
      <li class="breadcrumb-item">
        <a href="{% url 'projects:home' %}" class="breadcrumb-link">
          <i class="fas fa-home" aria-hidden="true"></i>
          <span>Home</span>
        </a>
      </li>

      {% if request.resolver_match.url_name == 'project_list' or request.resolver_match.url_name == 'list' %}
      <li class="breadcrumb-item active">
        <span class="breadcrumb-current">
          <i class="fas fa-project-diagram" aria-hidden="true"></i>
          <span>Projects</span>
        </span>
      </li>

      {% elif request.resolver_match.url_name == 'detail' and project %}
      <li class="breadcrumb-item">
        <a href="{% url 'projects:list' %}" class="breadcrumb-link">
          <i class="fas fa-project-diagram" aria-hidden="true"></i>
          <span>Projects</span>
        </a>
      </li>
      <li class="breadcrumb-item active">
        <span class="breadcrumb-current">
          <i class="fas fa-eye" aria-hidden="true"></i>
          <span>{{ project.title|truncatechars:30 }}</span>
        </span>
      </li>

      {% elif request.resolver_match.url_name == 'create' %}
      <li class="breadcrumb-item active">
        <span class="breadcrumb-current">
          <i class="fas fa-plus" aria-hidden="true"></i>
          <span>Create Project</span>
        </span>
      </li>

      {% elif request.resolver_match.url_name == 'edit' and project %}
      <li class="breadcrumb-item">
        <a href="{% url 'projects:list' %}" class="breadcrumb-link">
          <i class="fas fa-project-diagram" aria-hidden="true"></i>
          <span>Projects</span>
        </a>
      </li>
      <li class="breadcrumb-item">
        <a href="{% url 'projects:detail' project.id %}" class="breadcrumb-link">
          <i class="fas fa-eye" aria-hidden="true"></i>
          <span>{{ project.title|truncatechars:20 }}</span>
        </a>
      </li>
      <li class="breadcrumb-item active">
        <span class="breadcrumb-current">
          <i class="fas fa-edit" aria-hidden="true"></i>
          <span>Edit</span>
        </span>
      </li>

      {% elif request.resolver_match.url_name == 'dashboard' %}
      <li class="breadcrumb-item active">
        <span class="breadcrumb-current">
          <i class="fas fa-tachometer-alt" aria-hidden="true"></i>
          <span>Dashboard</span>
        </span>
      </li>

      {% elif request.resolver_match.url_name == 'my_projects' %}
      <li class="breadcrumb-item active">
        <span class="breadcrumb-current">
          <i class="fas fa-folder" aria-hidden="true"></i>
          <span>My Projects</span>
        </span>
      </li>

      {% elif request.resolver_match.url_name == 'my_contributions' %}
      <li class="breadcrumb-item active">
        <span class="breadcrumb-current">
          <i class="fas fa-heart" aria-hidden="true"></i>
          <span>My Contributions</span>
        </span>
      </li>

      {% elif request.resolver_match.url_name == 'profile' %}
      <li class="breadcrumb-item active">
        <span class="breadcrumb-current">
          <i class="fas fa-user" aria-hidden="true"></i>
          <span>Profile</span>
        </span>
      </li>

      {% elif request.resolver_match.url_name == 'login' %}
      <li class="breadcrumb-item active">
        <span class="breadcrumb-current">
          <i class="fas fa-sign-in-alt" aria-hidden="true"></i>
          <span>Login</span>
        </span>
      </li>

      {% elif request.resolver_match.url_name == 'register' %}
      <li class="breadcrumb-item active">
        <span class="breadcrumb-current">
          <i class="fas fa-user-plus" aria-hidden="true"></i>
          <span>Register</span>
        </span>
      </li>

      {% elif request.resolver_match.url_name == 'password_reset' %}
      <li class="breadcrumb-item active">
        <span class="breadcrumb-current">
          <i class="fas fa-key" aria-hidden="true"></i>
          <span>Reset Password</span>
        </span>
      </li>

      {% else %}
      <li class="breadcrumb-item active">
        <span class="breadcrumb-current">
          {{ page_title|default:request.resolver_match.url_name|title }}
        </span>
      </li>
      {% endif %}
    </ol>
  </div>
</nav>
{% endif %}

<style>
  .breadcrumb-nav {
    background-color: var(--gray-100);
    border-bottom: 1px solid var(--gray-200);
    padding: var(--spacing-sm) 0;
    margin-bottom: var(--spacing-lg);
  }

  .breadcrumb {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    list-style: none;
    margin: 0;
    padding: 0;
    font-size: var(--font-size-sm);
  }

  .breadcrumb-item {
    display: flex;
    align-items: center;
    color: var(--gray-600);
  }

  .breadcrumb-item:not(:last-child):after {
    content: "/";
    margin: 0 var(--spacing-sm);
    color: var(--gray-400);
    font-weight: normal;
  }

  .breadcrumb-link {
    color: var(--primary-color);
    text-decoration: none;
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    padding: var(--spacing-xs) var(--spacing-sm);
    border-radius: var(--border-radius);
    transition: var(--transition);
  }

  .breadcrumb-link:hover {
    color: var(--primary-dark);
    background-color: var(--gray-200);
    text-decoration: none;
  }

  .breadcrumb-link:focus {
    outline: 2px solid var(--primary-color);
    outline-offset: 2px;
  }

  .breadcrumb-current {
    color: var(--gray-700);
    font-weight: 500;
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
  }

  .breadcrumb-item.active .breadcrumb-current {
    color: var(--gray-800);
  }

  .breadcrumb-item i {
    font-size: 0.875rem;
    opacity: 0.8;
  }

  @media (max-width: 768px) {
    .breadcrumb-nav {
      padding: var(--spacing-xs) 0;
      margin-bottom: var(--spacing-md);
    }

    .breadcrumb {
      font-size: 0.8rem;
    }

    .breadcrumb-item:not(:last-child):after {
      margin: 0 var(--spacing-xs);
    }

    .breadcrumb-link,
    .breadcrumb-current {
      padding: var(--spacing-xs);
      gap: 4px;
    }
  }

  @media (max-width: 480px) {
    .breadcrumb-link span:not(.sr-only),
    .breadcrumb-current span {
      display: none;
    }

    .breadcrumb-link,
    .breadcrumb-current {
      min-width: 24px;
      justify-content: center;
    }
  }

  @media (prefers-contrast: high) {
    .breadcrumb-nav {
      background-color: var(--white);
      border-bottom: 2px solid var(--gray-800);
    }

    .breadcrumb-link {
      color: var(--gray-900);
    }

    .breadcrumb-link:hover {
      background-color: var(--gray-300);
    }

    .breadcrumb-current {
      color: var(--gray-900);
    }
  }

  @media (prefers-reduced-motion: reduce) {
    .breadcrumb-link {
      transition: none;
    }
  }

  @media print {
    .breadcrumb-nav {
      display: none;
    }
  }
</style>